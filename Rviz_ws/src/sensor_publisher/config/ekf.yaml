# ekf_filter_node:
#   ros__parameters:
#     use_sim_time: false
#     frequency: 50.0
#     sensor_timeout: 0.1
#     two_d_mode: true

#     publish_tf: true
#     map_frame: map
#     odom_frame: odom
#     base_link_frame: base_link
#     world_frame: odom

#     imu0_sample_delay: 0.01
#     odom0_sample_delay: 0.01
#     predict_to_current_time: true

#     odom0: /wheel_odom
#     odom0_config: [true, true, false,
#                    false, false, true,
#                    true, false, false,
#                    false, false, false]
#     odom0_differential: false
#     odom0_relative: false

#     imu0:  /imu
#     imu0_config: [false, false, false,
#                    false, false, false,
#                    false, false, false,
#                   true, true, true]
#     imu0_differential: false
#     imu0_remove_gravitational_acceleration: true

    # process_noise_covariance: [0.05, 0, 0, 0, 0, 0, 0, 0.05, 0, 0, 0, 0, 0, 0, 0.06, 0, 0, 0, 0, 0, 0, 0.03, 0, 0, 0, 0, 0, 0, 0.04, 0, 0, 0, 0, 0, 0, 0.04]
    # initial_estimate_covariance: [0.1, 0, 0, 0, 0, 0, 0, 0.1, 0, 0, 0, 0, 0, 0, 0.1, 0, 0, 0, 0, 0, 0, 0.1, 0, 0, 0, 0, 0, 0, 0.1, 0, 0, 0, 0, 0, 0, 0.1]

ekf_filter_node:
  ros__parameters:
    use_sim_time: false
    frequency: 40.0
    sensor_timeout: 0.1
    two_d_mode: true
    transform_time_offset: 0.0
    transform_timeout: 0.2
    print_diagnostics: true
    debug: false

    publish_tf: true
    map_frame: map
    odom_frame: odom
    base_link_frame: base_link
    world_frame: odom

    odom0: /wheel_odom
    odom0_config: [true, true, false,
                  false, false, true,
                  true,  true,  false,
                  false, false, true,
                  false, false, false]
    # odom0_config: [true, true, false,
    #           false, false, false,
    #           true,  true,  false,
    #           false, false, false,
    #           false, false, false]
    odom0_queue_size: 10
    odom0_nodelay: true
    odom0_differential: false
    odom0_relative: false

    imu0: /imu
    imu0_config: [false, false, false,
                  false, false, false,
                  true,  true,  false,
                  false, false, false,
                  true,  true,  false]
    # imu0_config: [false, false, false,
    #           false, false, true,
    #           true,  true,  false,
    #           false, false, true,
    #           true,  true,  false]
    imu0_nodelay: false
    imu0_differential: false
    imu0_relative: false
    imu0_queue_size: 20
    imu0_remove_gravitational_acceleration: true

    use_control: false

    process_noise_covariance: [1e-3, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                                0.0, 1e-3, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                                0.0, 0.0, 1e-3, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                                0.0, 0.0, 0.0, 0.3, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                                0.0, 0.0, 0.0, 0.0, 0.3, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                                0.0, 0.0, 0.0, 0.0, 0.0, 0.01, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                                0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                                0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                                0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                                0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.3, 0.0, 0.0, 0.0, 0.0, 0.0,
                                0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.3, 0.0, 0.0, 0.0, 0.0,
                                0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.3, 0.0, 0.0, 0.0,
                                0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.3, 0.0, 0.0,
                                0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.3, 0.0,
                                0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.3]

    initial_estimate_covariance: [1e-9, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                                  0.0, 1e-9, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                                  0.0, 0.0, 1e-9, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                                  0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                                  0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                                  0.0, 0.0, 0.0, 0.0, 0.0, 1e-9, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                                  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                                  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                                  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                                  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                                  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0,
                                  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0,
                                  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0,
                                  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0,
                                  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]


  # navsat_transform:
  #   frequency: 40
  #   delay: 1.0
  #   magnetic_declination_radians: 0.0429351  # For lat/long 55.944831, -3.186998
  #   yaw_offset: 1.570796327  # IMU reads 0 facing magnetic north, not east
  #   zero_altitude: false
  #   broadcast_utm_transform: true
  #   publish_filtered_gps: false
  #   use_odometry_yaw: false
  #   wait_for_datum: false

# ekf_map_node:
#   ros__parameters:
#     use_sim_time: false
#     frequency: 30.0
#     sensor_timeout: 0.1
#     two_d_mode: true
#     predict_to_current_time: true
#     transform_time_offset: 0.0
#     transform_timeout: 0.5

#     # 该滤波器发布 map->odom
#     publish_tf: true
#     map_frame: map
#     odom_frame: odom
#     base_link_frame: base_link
#     world_frame: map
  

#     # ------- 全局位姿源（可选，使用时取消注释并按实际话题替换）-------
#     # 典型：/amcl_pose 或 SLAM 的 pose, 类型 geometry_msgs/PoseWithCovarianceStamped
#     # pose0: /amcl_pose
#     # pose0_config: [true, true, false,
#     #                false, false, true,
#     #                false, false, false,
#     #                false, false, false,
#     #                false, false, false]
#     # pose0_queue_size: 5
#     # pose0_rejection_threshold: 5.0
#     # pose0_nodelay: false
#     # pose0_differential: false
#     # pose0_relative: false

#     # 也可以继续融合 wheel odom + imu，以提高频率与稳定性
#     odom0: /wheel_odom
#     odom0_config: [true,  true,  false,
#                    false, false, true,
#                    true,  false, false,
#                    false, false, false,
#                    false, false, false]
#     odom0_queue_size: 10
#     odom0_nodelay: true
#     odom0_differential: false
#     odom0_relative: false

#     imu0: /imu
#     imu0_config: [false, false, false,
#                   true,  true,  false,
#                   false, false, false,
#                   true,  true,  true,
#                   true,  true,  true]
#     imu0_queue_size: 20
#     imu0_nodelay: false
#     imu0_differential: false
#     imu0_relative: false
#     imu0_remove_gravitational_acceleration: true

#     use_control: false

#     # 这里先沿用与 odom ekf 类似的噪声，后期按需要独立调
#     process_noise_covariance: [1e-3, 0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
#                                 0,    1e-3, 0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
#                                 0,    0,    1e-3, 0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
#                                 0,    0,    0,    0.3,  0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
#                                 0,    0,    0,    0,    0.3,  0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
#                                 0,    0,    0,    0,    0,    0.01, 0,    0,    0,    0,    0,    0,    0,    0,    0,
#                                 0,    0,    0,    0,    0,    0,    0.5,  0,    0,    0,    0,    0,    0,    0,    0,
#                                 0,    0,    0,    0,    0,    0,    0,    0.5,  0,    0,    0,    0,    0,    0,    0,
#                                 0,    0,    0,    0,    0,    0,    0,    0,    0.1,  0,    0,    0,    0,    0,    0,
#                                 0,    0,    0,    0,    0,    0,    0,    0,    0,    0.3,  0,    0,    0,    0,    0,
#                                 0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0.3,  0,    0,    0,    0,
#                                 0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0.3,  0,    0,    0,
#                                 0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0.3,  0,    0,
#                                 0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0.3,  0,
#                                 0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0.3]

#     initial_estimate_covariance: [1e-9, 0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
#                                   0,    1e-9, 0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
#                                   0,    0,    1e-9, 0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
#                                   0,    0,    0,    1.0,  0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
#                                   0,    0,    0,    0,    1.0,  0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
#                                   0,    0,    0,    0,    0,    1e-9, 0,    0,    0,    0,    0,    0,    0,    0,    0,
#                                   0,    0,    0,    0,    0,    0,    1.0,  0,    0,    0,    0,    0,    0,    0,    0,
#                                   0,    0,    0,    0,    0,    0,    0,    1.0,  0,    0,    0,    0,    0,    0,    0,
#                                   0,    0,    0,    0,    0,    0,    0,    0,    1.0,  0,    0,    0,    0,    0,    0,
#                                   0,    0,    0,    0,    0,    0,    0,    0,    0,    1.0,  0,    0,    0,    0,    0,
#                                   0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    1.0,  0,    0,    0,    0,
#                                   0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    1.0,  0,    0,    0,
#                                   0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    1.0,  0,    0,
#                                   0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    1.0,  0,
#                                   0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    1.0
#                                   ]